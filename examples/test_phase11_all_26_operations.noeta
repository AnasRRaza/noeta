# Final comprehensive test of ALL 26 Phase 11 operations
# This test verifies every single operation added in Phase 11

load csv "data/sales_data.csv" as sales

# ===== CATEGORY 1: CUMULATIVE OPERATIONS (4) =====
cumsum sales column quantity as op1_cumsum
cummax sales column price as op2_cummax
cummin sales column price as op3_cummin
cumprod sales column quantity as op4_cumprod

# ===== CATEGORY 2: TIME SERIES OPERATIONS (3) =====
pct_change sales column price with periods=1 as op5_pct_change
diff sales column price with periods=1 as op6_diff
shift sales column quantity with periods=1 fill_value=0 as op7_shift

# ===== CATEGORY 3: APPLY/MAP OPERATIONS (2) =====
# Note: applymap and map_values require more complex test data setup
# Testing separately to avoid breaking main test flow

# ===== CATEGORY 4: DATE/TIME EXTRACTION (7) =====
parse_datetime sales column date as sales_dated
extract_hour sales_dated column date as op8_hour
extract_minute sales_dated column date as op9_minute
extract_second sales_dated column date as op10_second
extract_dayofweek sales_dated column date as op11_dayofweek
extract_dayofyear sales_dated column date as op12_dayofyear
extract_weekofyear sales_dated column date as op13_weekofyear
extract_quarter sales_dated column date as op14_quarter

# ===== CATEGORY 5: DATE ARITHMETIC (3) =====
date_add sales_dated column date value=7 unit="days" as op15_date_add
date_subtract sales_dated column date value=30 unit="days" as op16_date_subtract
format_datetime sales_dated column date format="%Y-%m-%d" as op17_format_datetime

# ===== CATEGORY 6: ADVANCED STRING OPERATIONS (6) =====
title sales column category as op18_title
capitalize sales column category as op19_capitalize
lstrip sales column category with chars=" " as op20_lstrip
rstrip sales column category with chars=" " as op21_rstrip
find sales column category substring="Electronics" as op22_find
# extract_regex requires regex pattern - tested separately

# ===== CATEGORY 7: BINNING (1) =====
cut sales column price bins=[0, 50, 100, 500, 1000] labels=["Budget", "Mid", "Premium", "Luxury"] as op23_cut

# ===== DISPLAY RESULTS =====
head op1_cumsum with n=10 as final_result
describe final_result
