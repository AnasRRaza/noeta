# Basic test for Phase 12 operations
load csv "data/sales_data.csv" as sales

# Test Scaling Operations
robust_scale sales column price as test_robust
maxabs_scale sales column quantity as test_maxabs

# Test Encoding Operations
target_encode sales column category target="price" as test_target_encode

# Test Index Operations
reindex sales with index=[0, 1, 2, 3, 4, 5] as test_reindex
set_multiindex sales columns ["category", "customer_id"] as test_multiindex

# Test Boolean Operations (create boolean column first)
mutate sales with has_discount = discount > 5 as sales_with_flag
any sales_with_flag column has_discount
count_true sales_with_flag column has_discount

# Display result
head test_robust with n=5 as result
describe result
