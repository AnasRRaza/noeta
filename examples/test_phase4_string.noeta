# Test Phase 4B: String Operations
load csv "data/sales_data.csv" as sales

# Test UPPER
upper sales column product_id as upper_case

# Test LOWER
lower sales column product_id as lower_case

# Test STRIP
strip sales column product_id as trimmed

# Test REPLACE
replace sales column product_id old="P" new="PROD" as replaced

# Test SPLIT
split sales column product_id delimiter="0" as split_prod

# Test CONCAT
concat sales columns ["product_id", "category"] separator="-" as combined

# Test SUBSTRING
substring sales column product_id start=0 end=3 as substr

# Test LENGTH
length sales column product_id as name_length

describe name_length
