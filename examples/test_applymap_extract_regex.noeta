# Test the remaining 2 operations: applymap and extract_regex
load csv "data/sales_data.csv" as sales

# Test extract_regex - extract product IDs (pattern: P001, P002, etc.)
# Syntax: extract_regex data column text pattern="regex" group=0 as result
extract_regex sales column product_id pattern="[A-Z][0-9]{3}" group=0 as op_extract_regex

# Test applymap - apply function to entire DataFrame
# Syntax: applymap data function="lambda x: ..." as result
applymap sales function="lambda x: str(x).upper() if isinstance(x, str) else x" as op_applymap

# Display results
head op_extract_regex with n=5 as result
describe result
