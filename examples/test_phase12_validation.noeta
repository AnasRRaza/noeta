# Test Phase 12 Validation and Encoding Operations
load csv "data/sales_data.csv" as sales

# Test Ordinal Encoding - need to create sample data with categorical values
# For demonstration, create a size column
mutate sales with size_code = product_id as sales_with_size
# Note: In real usage, you'd have actual size values like ["S", "M", "L", "XL"]

# Test Validation Operations
# These will pass if the data meets the criteria

# Test 1: Assert Unique - check if product_id is unique
# assert_unique sales column product_id

# Test 2: Assert No Nulls - check if price has no nulls
# assert_no_nulls sales column price

# Test 3: Assert Range - check if quantity is within range
# assert_range sales column quantity min=0 max=100

# Display results
describe sales
