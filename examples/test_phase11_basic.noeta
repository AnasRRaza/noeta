# Basic test of Phase 11 operations (without complex operations)
load csv "data/sales_data.csv" as sales

# 1. Cumulative Operations
cumsum sales column quantity as test_cumsum
cummax sales column price as test_cummax
cummin sales column price as test_cummin
cumprod sales column quantity as test_cumprod

# 2. Time Series Operations
pct_change sales column price with periods=1 as test_pct_change
diff sales column price with periods=1 as test_diff
shift sales column quantity with periods=1 fill_value=0 as test_shift

# 3. Date/Time Extraction
parse_datetime sales column date as sales_dated
extract_hour sales_dated column date as test_hour
extract_minute sales_dated column date as test_minute
extract_second sales_dated column date as test_second
extract_dayofweek sales_dated column date as test_dayofweek
extract_dayofyear sales_dated column date as test_dayofyear
extract_weekofyear sales_dated column date as test_weekofyear
extract_quarter sales_dated column date as test_quarter

# 4. Date Arithmetic
date_add sales_dated column date value=7 unit="days" as test_date_add
date_subtract sales_dated column date value=30 unit="days" as test_date_subtract
format_datetime sales_dated column date format="%Y-%m-%d" as test_format_datetime

# 5. String Operations
title sales column category as test_title
capitalize sales column category as test_capitalize

# 6. Binning
cut sales column price bins=[0, 50, 100, 500, 1000] labels=["Budget", "Mid", "Premium", "Luxury"] as test_cut

# Display summary
describe test_cumsum
